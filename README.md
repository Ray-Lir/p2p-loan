＃p2p-loan
***
# p2p金融借贷项目
* * *
2020-05-115 12:05
* * *

## **业务模式**
### P2P 网贷平台构成
* 理财端
理财端通常是围绕出借人业务展开的。理财端展现方式：PC 电脑、H5 页面、APP 应用
* 借款端
借款端展现方式：PC 电脑
### 项目基本开发流程
1) 公司领导层做出决策；
2) 产品经理根据领导决策勾勒产品需求原型；
3) 产品+设计+技术+测试 需求评审讨论；
4) 评审讨论调整后进入设计阶段，视觉设计+页面设计
5) 技术团队技术架构+技术选型+存储+服务器+运维等
### 相关技术及开发工具
* 前端：jQuery + Thymeleaf
* 后端：SpringBoot + SpringMVC + Spring + Dubbo + mybatis
* 相关组件：HttpComponents、Apache commons、Druid、spring-data-redis
* 服务器端：Tomcat、Redis、Zookeeper、MySQL
* 项目依赖管理：Maven
* 项目开发工具：IDEA
## 数据库表结构

*   ||用户表(u_user)||
    |----------------|:-------------:|----------:|
    |用户标识(id)        |int(11)          |  `<pk>`  |
    |用户手机号(phone)      |  varchar(11)    |         |
    |用户登录密码(login_password)    |    varchar(32)   |        |
    |用户姓名(name)        |varchar(16)    |           |
    |用户身份证号码(id_card)  |      varbinary(18)|       |
    |注册时间(add_time)        |datetime    |              |
    |最近登录时间(last_login_time)    |    datetime |             |
    ***
*   ||用户投标信息表(b_bid_info)||
    |-------|-------|------|
    |投标记录标识(id)|int(11)|`<pk>`|
    |产品标识(loan_id)|int(11)|`<fk2>`|
    |用户标识(uid)|int(11)|`<fk1>`|
    |投标金额(bid_money)|double||
    |投标时间(bid_time)|datetime||
    |投标状态(bid_status)|int(11)||
    ***
*   ||投标产品信息表(b_loan_info)||
    |------|-------|--------|
    |产品标识(id)   |int(11)|`<pk>`|
    |产品名称(product_name)   |varchar(50)||
    |产品利率(rate)   |double||
    |产品周期(cycle)   |int(11)||
    |产品发布时间(release_time)   |datetime||
    |产品类型(product_type)   |int(11)||
    |产品编号(product_no)   |varchar(50)||
    |产品募集资金（产品金额）(product_money)   |double||
    |产品剩余可投金额(left_product_money)   |double||
    |起投金额（最小投资金额）(bid_min_limit)   |double||
    |每笔投资最大金额(bid_max_limit)   |double(0,0)||
    |产品状态(product_status)   |int(11)||
    |产品满标时间(product_full_time)   |datetime||
    |产品描述(product_desc)   |text||
    |版本号(version)   |int(11)||
    ***
*   ||用户充值记录表(b_recharge_record)||
    |--------|-------|-------------|
    |充值记录标识(id)|int(11)|`<pk>`|
    |用户标识(uid)|int(11)|`<fk>`|
    |充值订单号(recharge_no)|varchar(50)||
    |充值订单状态(recharge_status)|varchar(50)||
    |充值金额(recharge_money)|double||
    |充值时间(recharge_time)|datetime||
    |充值描述(recharge_desc)|varchar(50)||
    ***
*   ||用户收益记录表(b_income_record)||
    |---|---|----|
    |用户收益记录标识(id)|int(11)|`<pk>`|
    |用户标识(uid)|int(11)|`<fk1>`|
    |产品标识(loan_id)|int(11)|`<fk2>`|
    |投标记录标识(bid_id)|int(11)|`<fk3>`|
    |投资金额(bid_money)|double|
    |收益时间(income_date)|datetime|
    |收益金额(income_money)|double|
    |收益状态(income_status)|int(11)|
    ***
*   ||用户财务资金账户表(u_finance_account)||
    |--------|----------|--------|
    |用户财务资金账户标识(id)|int(11)|`<pk>`|
    |用户标识(udi)|int(11)|`<fk>`|
    |用户可用资金(available_money)|double|
    ***
    ***


## **业务功能**
### P2P首页展示
#### 业务规则
1. 按照发布日期，新手宝理财产品只展示第 1 个
2. 按照发布日期，优先类理财产品展示前 4 个
3. 按照发布日期，散标类理财产品展示前 8 个
4. 显示平台历史年化收益率：所有理财产品年化收益的平均值
5. 平台注册总人数
6. 平台总投资金额
7. 历史年化收益率、注册总人数、总投资金额先从缓存中获取
###分页展示产品信息
#### 业务规则
1. 用户点击“查看更多 xxx 产品”跳转至该类产品分页显示页面，进行分页展示产品信息
### 展示商品详情页面
#### 业务规则
1. 在首页面或分页展示产品页面中，用户点击“立即投资”跳转至产品详情页面
2. 在产品详情页面中，用户未登录时，不能进行投资操作
3. 根据用户投资时间，倒序显示该产品投资记录
4. 投资记录中，用户手机号保留前三位与最后两位

## **注册功能**
#### 业务规则
1. 用户输入手机号必须进行验证
a) 手机号不能为空
b) 手机号格式
c) 手机号是否已被注册
2. 密码验证格式：
a) 密码不能为空
b) 密码字符只可使用数字和大小写英文字母
c) 密码应同时包含英文或数字
d) 密码应为 6-16 位
e) 两次输入密码必须一致
3. 再次验证登录密码
a) 上次验证有错，隐藏提示信息
b) 第一次密码是否为空
c) 第二次密码是否为空
d) 判断两次是否一致
4. 验证短信验证码：不能为空
5. 提交注册：需要所有验证都通过
6. 密码使用 JQuery 提供的 MD5 在页面进行加密
7. 注册必须使用 POST 请求
8. 验证仍然需要在后台服务端再次进行验证
9. 注册成功开立帐户

## **实名认证**
### 业务规则
1. 验验证真实姓名格式
a) 姓名不能为空
b) 真实姓名只能输入中文
2. 验证身份证号码：只能通过后台服务进行验证
a) 身份号码不能为空
b) 验证身份证号码格式
c) 身份证号码应为 15 或 18 位
d) 两次输入的身份证号是否一致
3. 验证再次输入身份号码
a) 如果上次验证没过，隐藏错误信息
b) 第一次输入不能为空
c) 第二次输入不能为空
d) 判断两次是否一致
4. 验证图形验证码
5. 服务端需要再次进行验证
6. 调用第三方系统接口，认证用户身份
7. 认证成功跳转至个人中心页面


## **平台统计信息**
### 业务规则
1. 平台总用户数
2. 平台总投资金额
3. 平台历史年化收益率

## **用户登录**
### 业务规则
1. 验证手机号格式
a) 手机号不能为空
b) 手机号格式
2. 登录密码不能为空
3. 验证短信验证码
4. 后台服务端需要再次验证
5. 验证全部通过才可提交登录


## **个人中心**
### 业务规则
1. 展示用户基本信息
a) 如果用户未实名认证，点击“实名认证”
2. 展示用户财务信息
3. 按投资时间倒序，展示最近 5 笔投资记录，可点击“查看全部投资记录”
4. 按充值时间倒序，展示最近 5 笔充值记录，可点击“查看全部充值记录”
5. 按收益时间倒序，展示最近 5 笔收益记录，可点击“查看全部收益记录”

## **个人中心-分页查询投资记录**
### 业务规则
1. 分页查询投资记录，按照投资时间倒序展示

## **个人中心-分页查询充值记录**
### 业务规则
1. 分页查询充值记录：按照充值时间倒序展示

## **个人中心-分页查询收益记录**
### 业务规则
1. 分页查询收益记录：按照收益时间倒序展示

## **用户退出**
### 业务规则
1. 将 session 中的用户信息和账户信息清空

## **我的账户**
### 业务规则
1. 用户未认证，姓名和身份号码显示“请认证”，已认证，显示用户真实姓名和身份证号
码

## **投资**
### 业务规则
1. 验证用户输入投资金额
a) 投资金额不能为空
b) 投资金额应为大于 0 的整数
c) 投资金额应为 100 的整数
d) 投资金额不能低于起投金额
e) 单笔投资金额不能超过最大投资限额
f) 验证通过计算预计本息收益
2. 计算预计本息收益，公式如下：
本息收益 = 投资金额 * （年化利率/100/365）* 投资周期
投资周期：单位为天
3. 投资请求
a) 产品是否已经满标
b) 验证用户输入投资金额，即 1
c) 验证用户是否登录，未登录，点击“立即投资”跳转至用户登录页面
d) 验证用户是否实名认证，未认证，点击“认证”跳转至实名认证页面
e) 判断投资金额是否大于账户余额
4. 后台判断用户账户余额是否充足
5. 用户未登录，资金显示：请登录
6. 投资业务
a) 更新产品剩余可投金额
b) 更新账户金额
c) 新增投资记录
d) 更新投资排行榜
e) 更新平台总投资金额
7. 更新 session 中账户信息

## **第三方支付**
### 业务规则
1. 支付宝
2. 微信
